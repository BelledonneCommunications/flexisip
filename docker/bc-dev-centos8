FROM gitlab.linphone.org:4567/bc/public/linphone-sdk/bc-dev-centos8:20210421_python3_fix_pip

MAINTAINER Fran√ßois Grisez <francois.grisez@belledonne-communications.com>

ARG njobs=1

# Allow make to use several jobs basing on 'njobs' parameter.
ENV MAKEFLAGS="${MAKEFLAGS} -j${njobs}"

# Install extra Flexisip dependencies
RUN sudo su -c 'dnf -y install hiredis-devel jansson-devel libnghttp2-devel net-snmp-devel protobuf-devel speexdsp-devel wget && dnf -y clean all'

# Install CMake 3.13.5
COPY cmake_install.sh .
RUN ./cmake_install.sh 3.13.5 && rm cmake_install.sh
