FROM gitlab.linphone.org:4567/bc/public/linphone-sdk/bc-dev-debian10:20210217_python3

MAINTAINER Fran√ßois Grisez <francois.grisez@belledonne-communications.com>

# Add extra dependencies for Flexisip
RUN sudo su -c 'apt-get -y update && apt-get -y install libjansson-dev libmariadb-dev-compat libnghttp2-dev libprotobuf-dev libsnmp-dev protobuf-compiler && apt-get -y clean'

# Configure OpenSSL policy
# Setting 'CipherString' to 'DEFAULT@SECLEVEL=1' forces libssl to allow
# certificates which are signed with a SHA1 digest algorithm. This must
# be done because BC's internal CA uses SHA1 for signatures, which is
# forbidden by default since libssl v1.1.
# Please keep this modification until the CA certificates has been updated
# in each project.
RUN sudo sed -i -E 's/^CipherString[ ]*=(.*)$/CipherString = DEFAULT@SECLEVEL=1/' /etc/ssl/openssl.cnf
